import{f as ge,r as b,g as L,i as z,c,o as d,b as e,j as P,v as q,k as Y,m as R,t as M,n as Z,p as V,F as H,q as G,s as de,e as re,x as ke,y as W,w as ee,T as Se,a as Q,z as ue,A as Ie,B as he,C as Ae,D as Le,u as B,l as Ue,E as Ne}from"./app-DzKkwl6A.js";import{l as K,c as je}from"./confetti.module-D4zSDwt8.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J=ge.create({baseURL:"/api"});J.interceptors.request.use(s=>{const y=window.localStorage.getItem("taskflow_api_key");return y&&(s.headers["X-API-Key"]=y),s});J.interceptors.response.use(s=>s,s=>(K.error("There was a problem talking to the server. Try again in a moment."),Promise.reject(s)));const X={async get(s,y={}){const{data:n}=await J.get(s,{params:y});return n.success===!1&&n.error&&K.error(n.error),n},async post(s,y={}){const{data:n}=await J.post(s,y);return n.success===!1&&n.error&&K.error(n.error),n},async patch(s,y={}){const{data:n}=await J.patch(s,y);return n.success===!1&&n.error&&K.error(n.error),n},async delete(s){const{data:y}=await J.delete(s);return y.success===!1&&y.error&&K.error(y.error),y}};function Ve(){const s=b([]),y=b(!1),n=b(!1),p=b("all"),m=b(""),h=L(()=>{let a=s.value.slice();if(p.value==="me"?a=a.filter(t=>t.assigned_to===window.TaskflowCurrentUserId):p.value!=="all"&&p.value&&(a=a.filter(t=>t.assigned_to===Number(p.value))),m.value.trim().length){const t=m.value.toLowerCase();a=a.filter(o=>o.title.toLowerCase().includes(t)||(o.description||"").toLowerCase().includes(t))}return a}),v=L(()=>h.value.filter(a=>a.status==="todo")),C=L(()=>h.value.filter(a=>a.status==="in_progress")),$=L(()=>h.value.filter(a=>a.status==="done"));async function f(){y.value=!0;const a=performance.now();try{const t=await X.get("tasks",{assigned_to:p.value==="all"?null:p.value,search:m.value||null});t.success&&(s.value=t.tasks)}catch{}finally{const o=300-(performance.now()-a);o>0?setTimeout(()=>{y.value=!1},o):y.value=!1}}async function D(a){n.value=!0;try{const t=await X.post("tasks",a);return t.success&&t.task&&(s.value=[t.task,...s.value],K.success("New task created")),t.task||null}catch{return null}finally{n.value=!1}}async function S(a,t){const o=s.value.findIndex(g=>g.id===a);if(o===-1)return;const r={...s.value[o]};s.value[o]={...s.value[o],...t};try{const g=await X.patch(`tasks/${a}`,t);g.success&&g.task?(s.value[o]={...s.value[o],...g.task},g.status_changed_to==="done"&&A()):s.value[o]=r}catch{s.value[o]=r}}async function w(a,t,o){const r=s.value.findIndex(U=>U.id===a);if(r===-1)return;const g=s.value.map(U=>({...U})),N=a;j(N,!0),s.value[r].status=t,s.value[r].position=o;try{const U=await X.patch(`tasks/${a}/move`,{status:t,position:o});if(U.success&&U.task){const F=s.value.findIndex(te=>te.id===a);F!==-1&&(s.value[F]={...U.task,_isMoving:!1}),U.status_changed_to==="done"&&A()}else s.value=g}catch{s.value=g}finally{j(N,!1)}}async function I(a){const t=s.value.slice();s.value=s.value.filter(o=>o.id!==a);try{(await X.delete(`tasks/${a}`)).success?K.success("Task deleted"):s.value=t}catch{s.value=t}}async function T(a,t){const o=s.value.findIndex(g=>g.id===a);if(o===-1)return;const r={...s.value[o]};s.value[o].assigned_to=t;try{const g=await X.post(`tasks/${a}/assign`,{user_id:t});g.success&&g.task?(s.value[o]=g.task,K.success("Task assignment updated")):s.value[o]=r}catch{s.value[o]=r}}function j(a,t){const o=s.value.findIndex(r=>r.id===a);o!==-1&&(s.value[o]={...s.value[o],_isMoving:t})}function A(){je({particleCount:80,spread:70,origin:{y:.6}}),K.success("ðŸŽ‰ Task completed - great work!")}return{tasks:s,todoTasks:v,inProgressTasks:C,doneTasks:$,isLoading:y,isCreating:n,filterAssigned:p,search:m,loadTasks:f,createTask:D,updateTaskInline:S,moveTask:w,deleteTask:I,assignTask:T}}const Pe={class:"flex items-center justify-between gap-2"},Ee={class:"flex-1 min-w-0"},Ke=["onKeyup"],Be={class:"text-xs text-slate-500 dark:text-slate-300"},qe={class:"space-y-1"},Fe={key:0,class:"flex flex-wrap gap-1"},Oe=["onClick"],Re={key:1,class:"flex items-center gap-1 mt-1"},ze={class:"relative w-5 h-5 ml-1"},We={class:"flex items-center justify-between mt-1"},He={class:"flex items-center gap-2"},Ge={key:1,class:"text-[11px] text-slate-500 dark:text-slate-300 truncate max-w-[80px]"},Xe={key:2,class:"text-[11px] text-slate-400"},Ye={class:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity"},Je=["value"],Qe={__name:"TaskCard",props:{task:{type:Object,required:!0},teamMembers:{type:Array,default:()=>[]}},emits:["edit","delete","assign","drag-start"],setup(s,{emit:y}){const n=s,p=y,m=b(!1),h=b(!1),v=b(n.task.title),C=b(n.task.description||""),$=b(n.task.assigned_to||""),f=b(n.task.tags?[...n.task.tags]:[]),D=b(!1),S=b(""),w=b("#0ea5e9");z(()=>n.task.title,_=>{v.value=_}),z(()=>n.task.description,_=>{C.value=_||""}),z(()=>n.task.assigned_to,_=>{$.value=_||""}),z(()=>n.task.tags,_=>{f.value=_?[..._]:[]});const I=["high","medium","low"],T=L(()=>{switch(n.task.priority){case"high":return"bg-red-500/10 text-red-600 border-red-400/50";case"medium":return"bg-amber-500/10 text-amber-600 border-amber-400/50";default:return"bg-emerald-500/10 text-emerald-600 border-emerald-400/50"}}),j=L(()=>!!n.task._isMoving);function A(){const _=n.task.priority||"medium",x=I.indexOf(_),k=I[(x+1)%I.length];p("edit",{priority:k})}function a(){m.value=!1,v.value!==n.task.title&&p("edit",{title:v.value})}function t(){h.value=!1,C.value!==(n.task.description||"")&&p("edit",{description:C.value})}function o(_){_.dataTransfer.effectAllowed="move",_.dataTransfer.setData("text/plain",String(n.task.id)),p("drag-start",n.task)}function r(){p("assign",$.value||null)}function g(_){f.value=_,p("edit",{tags:_.map(x=>({id:x.id??void 0,name:x.name,color:x.color}))})}function N(_){const x=f.value.filter(k=>k.id&&_.id?k.id!==_.id:!(k.name===_.name&&k.color===_.color));g(x)}function U(){D.value=!0,S.value="",w.value="#0ea5e9"}function F(){D.value=!1,S.value=""}function te(){if(!S.value.trim())return;const _={name:S.value.trim(),color:w.value||"#0ea5e9"},x=[...f.value,_];g(x),S.value="",w.value="#0ea5e9",D.value=!1}return(_,x)=>(d(),c("div",{class:Z(["group cursor-grab active:cursor-grabbing transition-all duration-200 rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 shadow-sm hover:shadow-lg p-3 space-y-2 hover:-translate-y-1",[j.value?"opacity-60 scale-[0.99] pointer-events-none":""]]),draggable:"true",onDragstart:o},[e("div",Pe,[e("div",Ee,[m.value?P((d(),c("input",{key:0,"onUpdate:modelValue":x[0]||(x[0]=k=>v.value=k),type:"text",class:"w-full rounded-md text-sm font-semibold bg-transparent border-b border-blue-400 outline-none focus-visible:ring-0",onBlur:a,onKeyup:Y(R(a,["prevent"]),["enter"])},null,40,Ke)),[[q,v.value]]):(d(),c("button",{key:1,type:"button",class:"text-left text-sm font-semibold text-slate-900 dark:text-slate-50 truncate w-full focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900 rounded-sm",onClick:x[1]||(x[1]=k=>m.value=!0)},M(s.task.title),1))]),e("button",{type:"button",class:Z(["text-[11px] px-2 py-0.5 rounded-full border font-medium hover:brightness-110 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-amber-500 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900",T.value]),onClick:A,title:"Click to change priority"},M(s.task.priority.toUpperCase()),3)]),e("div",Be,[h.value?P((d(),c("textarea",{key:0,"onUpdate:modelValue":x[2]||(x[2]=k=>C.value=k),rows:"2",class:"w-full bg-transparent border border-blue-400 rounded-md p-1 outline-none focus-visible:ring-0",onBlur:t},null,544)),[[q,C.value]]):(d(),c("button",{key:1,type:"button",class:"text-left line-clamp-2 w-full focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900 rounded-sm",onClick:x[3]||(x[3]=k=>h.value=!0)},M(s.task.description||"Add a description..."),1))]),e("div",qe,[f.value.length?(d(),c("div",Fe,[(d(!0),c(H,null,G(f.value,k=>(d(),c("span",{key:k.id||k.name,class:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-medium",style:de({backgroundColor:(k.color||"#0ea5e9")+"20",color:k.color||"#0ea5e9"})},[re(M(k.name)+" ",1),e("button",{type:"button",class:"text-[9px] hover:opacity-70 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-current rounded-full",onClick:xe=>N(k)}," âœ• ",8,Oe)],4))),128))])):V("",!0),D.value?(d(),c("div",Re,[P(e("input",{"onUpdate:modelValue":x[4]||(x[4]=k=>S.value=k),type:"text",placeholder:"Tag label",class:"flex-1 dark:text-slate-400 text-[11px] rounded-full border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 px-2 py-0.5 focus:outline-none focus:ring-1 focus:ring-blue-400"},null,512),[[q,S.value]]),e("div",ze,[P(e("input",{"onUpdate:modelValue":x[5]||(x[5]=k=>w.value=k),type:"color",class:"color-circle absolute inset-0 w-full h-full cursor-pointer"},null,512),[[q,w.value]])]),e("button",{type:"button",class:"text-[11px] px-2 ml-1 py-0.5 rounded-md bg-blue-600 text-white hover:bg-blue-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900",onClick:te}," Save "),e("button",{type:"button",class:"text-[11px] px-2 ml-1 dark:text-slate-500 dark:hover:text-slate-400 py-0.5 rounded-md border border-slate-300 dark:border-slate-600 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-500 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900",onClick:F}," Cancel ")])):(d(),c("button",{key:2,type:"button",class:"text-[11px] text-blue-600 dark:text-emerald-300 hover:underline mt-1 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900 rounded-sm",onClick:U}," + Add tag "))]),e("div",We,[e("div",He,[s.task.assigned_user?(d(),c("div",{key:0,class:"w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-semibold text-white",style:de({backgroundColor:s.task.assigned_user.avatar_color||"#0f766e"})},M(s.task.assigned_user.name.slice(0,1).toUpperCase()),5)):V("",!0),s.task.assigned_user?(d(),c("span",Ge,M(s.task.assigned_user.name),1)):(d(),c("span",Xe," Unassigned "))]),e("div",Ye,[P(e("select",{"onUpdate:modelValue":x[6]||(x[6]=k=>$.value=k),class:"min-w-[8rem] text-[11px] dark:text-white rounded-md border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-900 px-2 py-0.5 focus:outline-none focus:ring-1 focus:ring-blue-400",onChange:r},[x[8]||(x[8]=e("option",{value:""},"Unassigned",-1)),(d(!0),c(H,null,G(s.teamMembers,k=>(d(),c("option",{key:k.id,value:k.id},M(k.name),9,Je))),128))],544),[[ke,$.value]]),e("button",{type:"button",class:"p-1 rounded-md hover:bg-red-50 dark:hover:bg-red-900/40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900",onClick:x[7]||(x[7]=k=>_.$emit("delete")),"aria-label":"Delete task"}," ðŸ—‘ï¸ ")])])],34))}},Ze=ie(Qe,[["__scopeId","data-v-049dd260"]]),et={class:"flex items-center justify-between mb-2"},tt={class:"flex items-center gap-2"},st={class:"text-xs font-semibold tracking-wide uppercase text-slate-500 dark:text-slate-300"},at={class:"text-[11px] px-2 py-0.5 rounded-full bg-slate-200/70 dark:bg-slate-800 text-slate-600 dark:text-slate-200"},lt={key:0,class:"space-y-2"},ot={key:"empty",class:"flex flex-col items-center justify-center text-center text-xs text-slate-400 dark:text-slate-500 border border-dashed border-slate-300/60 dark:border-slate-700 rounded-xl py-6 px-3 mt-2 bg-slate-50/60 dark:bg-slate-900/40"},nt={class:"text-xl mb-1"},rt={class:"font-medium mb-1 text-slate-600 dark:text-slate-200"},it={class:"mb-2"},dt={__name:"TaskColumn",props:{title:{type:String,required:!0},status:{type:String,required:!0},tasks:{type:Array,required:!0},isLoading:{type:Boolean,default:!1},teamMembers:{type:Array,default:()=>[]}},emits:["move-task","edit-task","delete-task","assign-task","open-create"],setup(s,{emit:y}){const n=s,p=y,m=b(!1),h=L(()=>n.tasks.length===1?"1 task":`${n.tasks.length} tasks`);function v(w){w.preventDefault();const I=Number(w.dataTransfer.getData("text/plain"));if(m.value=!1,!I)return;const T=n.tasks.length+1;p("move-task",{id:I,status:n.status,position:T})}function C(w){w.preventDefault(),w.dataTransfer.dropEffect="move",m.value=!0}function $(w){w.currentTarget===w.target&&(m.value=!1)}function f(){return n.status==="todo"?"Ready to tackle something new?":n.status==="in_progress"?"Nothing in motion yet.":"No wins here yet."}function D(){return n.status==="todo"?"Drop a task here or create a new one to get started.":n.status==="in_progress"?"Move a card here when you are actively working on it.":"Drag finished work here to celebrate your progress."}function S(){return n.status==="todo"?"âœ¨":n.status==="in_progress"?"ðŸš€":"ðŸŽ¯"}return(w,I)=>(d(),c("div",{class:Z(["flex flex-col rounded-2xl bg-slate-50 dark:bg-slate-900/40 border p-3 min-h-[260px] transition-colors duration-200 dark:shadow-lg dark:shadow-slate-900/20",["border-slate-200 dark:border-slate-700",m.value?"border-blue-500 bg-blue-50/80 dark:bg-slate-900 ring-1 ring-blue-400/60":""]]),onDrop:v,onDragover:C,onDragleave:$},[e("div",et,[e("div",tt,[e("h2",st,M(s.title),1),e("span",at,M(h.value),1)])]),s.isLoading?(d(),c("div",lt,[(d(),c(H,null,G(3,T=>e("div",{key:T,class:"animate-pulse rounded-xl border border-slate-200/70 dark:border-slate-700/70 bg-slate-100/80 dark:bg-slate-800/80 p-3 space-y-2"},[...I[0]||(I[0]=[e("div",{class:"h-3 w-2/3 rounded bg-slate-300 dark:bg-slate-700"},null,-1),e("div",{class:"h-2 w-full rounded bg-slate-300 dark:bg-slate-700"},null,-1),e("div",{class:"h-2 w-5/6 rounded bg-slate-300 dark:bg-slate-700"},null,-1)])])),64))])):(d(),W(Se,{key:1,name:"slide-fade",tag:"div",class:"space-y-2 flex-1"},{default:ee(()=>[(d(!0),c(H,null,G(s.tasks,T=>(d(),W(Ze,{key:T.id,task:T,"team-members":s.teamMembers,onEdit:j=>p("edit-task",{task:T,fields:j}),onDelete:()=>p("delete-task",{task:T}),onAssign:j=>p("assign-task",{task:T,userId:j})},null,8,["task","team-members","onEdit","onDelete","onAssign"]))),128)),s.tasks.length?V("",!0):(d(),c("div",ot,[e("div",nt,M(S()),1),e("p",rt,M(f()),1),e("p",it,M(D()),1)]))]),_:1}))],34))}},ve=ie(dt,[["__scopeId","data-v-a87bcd5e"]]),ut={class:"w-full max-w-md rounded-2xl bg-white dark:bg-slate-900 dark:border-2 dark:border-cyan-900 dark:shadow-slate-800 shadow-lg p-5 space-y-4"},ct={class:"flex items-center justify-between"},mt={class:"space-y-3"},ft={class:"grid grid-cols-2 gap-3"},pt=["value"],bt={class:"space-y-2"},vt={class:"flex items-center gap-2"},gt={class:"relative w-5 h-5 ml-1"},kt={key:0,class:"flex flex-wrap gap-1 mt-1"},xt=["onClick"],yt={class:"flex items-center justify-between pt-2"},ht=["disabled"],wt={__name:"CreateTaskModal",props:{show:{type:Boolean,default:!1},teamMembers:{type:Array,default:()=>[]}},emits:["close","submit"],setup(s,{emit:y}){const n=s,p=y,m=b(""),h=b(""),v=b("medium"),C=b(""),$=b([]),f=b(""),D=b("#0ea5e9");z(()=>n.show,A=>{A&&S()}),L(()=>m.value.trim().length>0||h.value.trim().length>0);function S(){m.value="",h.value="",v.value="medium",C.value="",$.value=[],f.value="",D.value="#0ea5e9"}function w(){f.value.trim()&&($.value.push({name:f.value.trim(),color:D.value||"#0ea5e9"}),f.value="")}function I(A){$.value.splice(A,1)}function T(){m.value.trim()&&p("submit",{title:m.value.trim(),description:h.value.trim()||null,priority:v.value,assigned_to:C.value?Number(C.value):null,tags:$.value,status:"todo"})}function j(A){A.target===A.currentTarget&&p("close")}return(A,a)=>(d(),W(ue,{name:"fade"},{default:ee(()=>[s.show?(d(),c("div",{key:0,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/30",onClick:j},[Q(ue,{name:"scale"},{default:ee(()=>[e("div",ut,[e("header",ct,[a[8]||(a[8]=e("h2",{class:"text-sm font-semibold text-slate-900 dark:text-slate-50"}," Create task ",-1)),e("button",{type:"button",class:"text-xs px-2 py-1 rounded-md hover:bg-slate-100 dark:hover:bg-slate-800",onClick:a[0]||(a[0]=t=>A.$emit("close"))}," âœ• ")]),e("div",mt,[e("div",null,[a[9]||(a[9]=e("label",{class:"block text-xs font-medium text-slate-500 mb-1"}," Title ",-1)),P(e("input",{"onUpdate:modelValue":a[1]||(a[1]=t=>m.value=t),type:"text",class:"w-full text-sm rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"Write a clear task title..."},null,512),[[q,m.value]])]),e("div",null,[a[10]||(a[10]=e("label",{class:"block text-xs font-medium text-slate-500 mb-1"}," Description ",-1)),P(e("textarea",{"onUpdate:modelValue":a[2]||(a[2]=t=>h.value=t),rows:"3",class:"w-full text-sm rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 px-2 py-1.5 focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"Add helpful context..."},null,512),[[q,h.value]])]),e("div",ft,[e("div",null,[a[12]||(a[12]=e("label",{class:"block text-xs font-medium text-slate-500 mb-1"}," Priority ",-1)),P(e("select",{"onUpdate:modelValue":a[3]||(a[3]=t=>v.value=t),class:"w-full text-sm rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-400"},[...a[11]||(a[11]=[e("option",{value:"low"},"Low",-1),e("option",{value:"medium"},"Medium",-1),e("option",{value:"high"},"High",-1)])],512),[[ke,v.value]])]),e("div",null,[a[14]||(a[14]=e("label",{class:"block text-xs font-medium text-slate-500 mb-1"}," Assignee ",-1)),P(e("select",{"onUpdate:modelValue":a[4]||(a[4]=t=>C.value=t),class:"w-full text-sm rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-400"},[a[13]||(a[13]=e("option",{value:""},"Unassigned",-1)),(d(!0),c(H,null,G(s.teamMembers,t=>(d(),c("option",{key:t.id,value:t.id},M(t.name),9,pt))),128))],512),[[ke,C.value]])])]),e("div",bt,[a[15]||(a[15]=e("label",{class:"block text-xs font-medium text-slate-500"}," Tags ",-1)),e("div",vt,[P(e("input",{"onUpdate:modelValue":a[5]||(a[5]=t=>f.value=t),type:"text",placeholder:"Tag name",class:"flex-1 text-xs rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-400"},null,512),[[q,f.value]]),e("div",gt,[P(e("input",{"onUpdate:modelValue":a[6]||(a[6]=t=>D.value=t),type:"color",class:"color-circle absolute inset-0 w-full h-full cursor-pointer"},null,512),[[q,D.value]])]),e("button",{type:"button",class:"text-xs px-2 py-1 rounded-lg bg-slate-900 text-white hover:bg-slate-800 active:scale-95 transition",onClick:w}," Add ")]),$.value.length?(d(),c("div",kt,[(d(!0),c(H,null,G($.value,(t,o)=>(d(),c("span",{key:o,class:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-medium",style:de({backgroundColor:t.color+"20",color:t.color})},[re(M(t.name)+" ",1),e("button",{type:"button",class:"text-[9px]",onClick:r=>I(o)}," âœ• ",8,xt)],4))),128))])):V("",!0)])]),e("footer",yt,[e("button",{type:"button",class:"text-xs text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200",onClick:a[7]||(a[7]=t=>A.$emit("close"))}," Cancel "),e("button",{type:"button",class:"text-xs px-3 py-1.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 active:scale-95 transition disabled:opacity-50",disabled:!m.value.trim().length,onClick:T}," Create task ",8,ht)])])]),_:1})])):V("",!0)]),_:1}))}},_t=ie(wt,[["__scopeId","data-v-2a1d2f33"]]),Ct={class:"w-full max-w-md rounded-2xl bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 shadow-xl overflow-hidden"},Tt={class:"border-b border-slate-200 dark:border-slate-700 px-3 py-2.5"},$t={class:"flex items-center gap-2"},Dt=["onKeydown"],Mt={class:"max-h-80 overflow-y-auto"},St={key:0,class:"px-3 py-4 text-xs text-slate-400"},It={key:1,class:"py-1 text-sm"},At=["onMouseenter","onClick"],Lt={class:"flex flex-col"},Ut={class:"text-xs font-medium"},Nt={key:0},jt={key:0,class:"text-[11px] text-slate-400 dark:text-slate-400"},Vt={class:"flex items-center gap-2 text-[10px] text-slate-400"},Pt={key:0,class:"px-1.5 py-0.5 rounded-md border border-slate-300 dark:border-slate-600"},Et=["onClick"],Kt={__name:"CommandPalette",props:{show:{type:Boolean,default:!1},tasks:{type:Array,default:()=>[]},teamMembers:{type:Array,default:()=>[]},currentUserId:{type:Number,default:null}},emits:["update:show","create-task","set-search","set-filter-assigned","switch-column","mark-task-done"],setup(s,{emit:y}){const n=s,p=y,m=b(!1),h=b(""),v=b(0),C=b(null);z(()=>n.show,t=>{t!==m.value&&(t?$():f())});function $(){m.value=!0,p("update:show",!0),h.value="",v.value=0,Ie(()=>{C.value&&C.value.focus()})}function f(){m.value=!1,p("update:show",!1)}function D(t){(t.metaKey||t.ctrlKey)&&t.key.toLowerCase()==="k"&&(t.preventDefault(),m.value?f():$()),t.key==="Escape"&&m.value&&(t.preventDefault(),f())}he(()=>{window.addEventListener("keydown",D)}),Ae(()=>{window.removeEventListener("keydown",D)});const S=L(()=>{const t=[];return t.push({id:"cmd-new-task",type:"command",label:"Create new task",description:"Open the new task modal",shortcut:"N",command:"create-task"}),t.push({id:"cmd-search",type:"command",label:"Search tasks",description:"Filter the board by text",shortcut:"/",command:"search"}),t.push({id:"filter-all",type:"command",label:"Show tasks for all users",description:"Clear assignee filter",command:"set-filter-assigned",payload:"all"}),n.currentUserId&&t.push({id:"filter-me",type:"command",label:"Show tasks assigned to me",description:"Filter to your tasks",command:"set-filter-assigned",payload:"me"}),n.teamMembers.forEach(o=>{t.push({id:`filter-user-${o.id}`,type:"command",label:`Show tasks for ${o.name}`,description:"Filter by team member",command:"set-filter-assigned",payload:o.id})}),t.push({id:"col-all",type:"command",label:"View all columns",description:"Show all task columns",command:"switch-column",payload:"all"},{id:"col-todo",type:"command",label:"View To Do column",description:"Focus the To Do column",command:"switch-column",payload:"todo"},{id:"col-in-progress",type:"command",label:"View In Progress column",description:"Focus the In Progress column",command:"switch-column",payload:"in_progress"},{id:"col-done",type:"command",label:"View Done column",description:"Focus the Done column",command:"switch-column",payload:"done"}),t}),w=L(()=>{const t=h.value.trim().toLowerCase(),r=(t.startsWith("/")?t.slice(1):t).trim();return!r||r.length<2?[]:n.tasks.filter(N=>{const U=(N.title||"").toLowerCase(),F=(N.description||"").toLowerCase();return U.includes(r)||F.includes(r)}).slice(0,6).map(N=>({id:`task-${N.id}`,type:"task",label:N.title||"(Untitled task)",description:"Filter the board to this task or mark it as done",taskId:N.id}))}),I=L(()=>{const t=h.value.trim().toLowerCase(),o=t.startsWith("/"),r=(o?t.slice(1):t).trim();return o?[]:r?S.value.filter(g=>{const N=g.label.toLowerCase(),U=(g.description||"").toLowerCase();return N.includes(r)||U.includes(r)}):S.value.slice(0,10)}),T=L(()=>[...I.value,...w.value]);z(()=>T.value.length,t=>{v.value>t-1&&(v.value=t===0?0:t-1)});function j(t){const o=T.value.length;if(!o)return;let r=v.value+t;r<0&&(r=o-1),r>=o&&(r=0),v.value=r}function A(){const t=T.value[v.value];if(t){if(t.type==="command")a(t);else if(t.type==="task"){const o=(t.label||"").trim();p("set-search",o)}f()}}function a(t){switch(t.command){case"create-task":p("create-task");break;case"search":{const o=h.value||"",r=o.startsWith("/")?o.slice(1).trim():o.trim();p("set-search",r);break}case"set-filter-assigned":p("set-filter-assigned",t.payload);break;case"switch-column":p("switch-column",t.payload);break}}return(t,o)=>(d(),W(Le,{to:"body"},[Q(ue,{name:"fade"},{default:ee(()=>[m.value?(d(),c("div",{key:0,class:"fixed inset-0 z-40 flex items-start justify-center pt-24 bg-black/40 backdrop-blur-sm",onClick:R(f,["self"])},[Q(ue,{name:"scale-fade"},{default:ee(()=>[e("div",Ct,[e("div",Tt,[e("div",$t,[o[3]||(o[3]=e("span",{class:"text-slate-400 text-sm"},"âŒ˜K",-1)),P(e("input",{ref_key:"inputRef",ref:C,"onUpdate:modelValue":o[0]||(o[0]=r=>h.value=r),type:"text",placeholder:"Search commands or tasks...",class:"flex-1 bg-transparent outline-none text-sm text-slate-900 dark:text-slate-50",onKeydown:[o[1]||(o[1]=Y(R(r=>j(1),["prevent"]),["down"])),o[2]||(o[2]=Y(R(r=>j(-1),["prevent"]),["up"])),Y(R(A,["prevent"]),["enter"]),Y(R(f,["prevent"]),["esc"])]},null,40,Dt),[[q,h.value]])])]),e("div",Mt,[T.value.length?(d(),c("ul",It,[(d(!0),c(H,null,G(T.value,(r,g)=>(d(),c("li",{key:r.id,class:Z(["px-3 py-2 flex items-center justify-between gap-2 cursor-pointer transition-colors",[g===v.value?"bg-blue-50 dark:bg-slate-800 text-slate-900 dark:text-slate-50":"text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-800/80"]]),onMouseenter:N=>v.value=g,onClick:()=>{v.value=g,A()}},[e("div",Lt,[e("span",Ut,[r.type==="task"?(d(),c("span",Nt,"âœ… ")):V("",!0),re(M(r.label),1)]),r.description?(d(),c("span",jt,M(r.description),1)):V("",!0)]),e("div",Vt,[r.type==="command"&&r.shortcut?(d(),c("span",Pt,M(r.shortcut),1)):V("",!0),r.type==="task"?(d(),c("button",{key:1,type:"button",class:"px-1.5 py-0.5 rounded-md border border-slate-300 dark:border-slate-600 hover:bg-emerald-50 dark:hover:bg-emerald-900/30",onClick:R(()=>{p("mark-task-done",r.taskId),f()},["stop"])}," Done ",8,Et)):V("",!0)])],42,At))),128))])):(d(),c("div",St," No matching commands or tasks. "))]),o[4]||(o[4]=e("div",{class:"border-t border-slate-200 dark:border-slate-700 px-3 py-2"},[e("div",{class:"flex items-center justify-between text-[11px] text-slate-400"},[e("span",null,"Use â†‘ â†“ to navigate, Enter to run, Esc to close."),e("span",null,"Cmd+K or Ctrl+K to open")])],-1))])]),_:1})])):V("",!0)]),_:1})]))}},Bt=ie(Kt,[["__scopeId","data-v-72f9f75e"]]),qt={class:"relative min-h-screen overflow-hidden bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-50"},Ft={class:"relative max-w-6xl mx-auto px-4 py-6 space-y-4"},Ot={class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between bg-white/80 dark:bg-slate-900/80 backdrop-blur rounded-2xl border border-slate-200/60 dark:border-slate-800 px-4 py-3"},Rt={class:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3 w-full sm:w-auto"},zt={class:"flex items-center gap-2 w-full sm:w-auto"},Wt={class:"flex items-center justify-between sm:justify-end gap-2"},Ht=["disabled"],Gt={key:0},Xt={key:1,class:"flex items-center gap-1"},Yt={class:"flex items-center gap-2"},Jt={key:1,class:"hidden sm:inline text-[11px] text-slate-500 dark:text-slate-300 truncate max-w-[120px]"},Qt=["aria-label"],Zt={key:0},es={key:1},ts={class:"hidden sm:inline"},ss={class:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between text-xs text-slate-500 mt-2 bg-white/80 dark:bg-slate-900/80 backdrop-blur rounded-2xl border border-slate-200/60 dark:border-slate-800 px-4 py-3"},as={class:"flex items-center gap-2"},ls={class:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 mt-2"},os={__name:"Dashboard",props:{auth:{type:Object,required:!1,default:()=>({})},teamMembers:{type:Array,default:()=>[]},errors:{type:Object,default:()=>({})}},setup(s){const y=b(null),n=b(null),p=b(null),m=b(null),h=b(!1),v=s,C=b(!1),$=b(!1),f=b("all"),D=L(()=>{var i,l;return((l=(i=v.auth)==null?void 0:i.user)==null?void 0:l.id)??null}),S=L(()=>{var i;return((i=v.auth)==null?void 0:i.user)??null}),w=L(()=>S.value?v.teamMembers.find(i=>i.id===S.value.id)??null:null),I=L(()=>f.value==="me"&&D.value?Number(D.value):f.value!=="all"&&f.value!=="me"&&f.value!=null&&f.value!==""?Number(f.value):null),{tasks:T,todoTasks:j,inProgressTasks:A,doneTasks:a,isLoading:t,isCreating:o,search:r,loadTasks:g,createTask:N,updateTaskInline:U,moveTask:F,deleteTask:te,assignTask:_}=Ve(),x=L(()=>{const i=I.value,l=r.value.trim().toLowerCase();return j.value.filter(u=>{var O;const E=u.assigned_to!=null?Number(u.assigned_to):null,se=((O=u.assigned_user)==null?void 0:O.id)!=null?Number(u.assigned_user.id):null,ae=i==null?!0:E===i||se===i,le=(u.title||"").toLowerCase(),oe=(u.description||"").toLowerCase(),ne=l?le.includes(l)||oe.includes(l):!0;return ae&&ne})}),k=L(()=>{const i=I.value,l=r.value.trim().toLowerCase();return A.value.filter(u=>{var O;const E=u.assigned_to!=null?Number(u.assigned_to):null,se=((O=u.assigned_user)==null?void 0:O.id)!=null?Number(u.assigned_user.id):null,ae=i==null?!0:E===i||se===i,le=(u.title||"").toLowerCase(),oe=(u.description||"").toLowerCase(),ne=l?le.includes(l)||oe.includes(l):!0;return ae&&ne})}),xe=L(()=>{const i=I.value,l=r.value.trim().toLowerCase();return a.value.filter(u=>{var O;const E=u.assigned_to!=null?Number(u.assigned_to):null,se=((O=u.assigned_user)==null?void 0:O.id)!=null?Number(u.assigned_user.id):null,ae=i==null?!0:E===i||se===i,le=(u.title||"").toLowerCase(),oe=(u.description||"").toLowerCase(),ne=l?le.includes(l)||oe.includes(l):!0;return ae&&ne})});async function we(){const i=window.localStorage.getItem("taskflow_api_key");if(i)return i;try{const{data:l}=await ge.get("/api-token");if(l.success&&l.api_key)return window.localStorage.setItem("taskflow_api_key",l.api_key),l.api_key}catch{K.error("Could not get API key. Please log in again.")}return null}he(async()=>{if(!await we())return;await g();const l=window.localStorage.getItem("theme"),u=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,E=l==="dark"||l==="light"?l:u?"dark":"light";console.log("initial theme:",E),ye(E)});function _e(i){if(i==="all"){m.value=null;return}m.value=i;const l={todo:y,in_progress:n,done:p},u=l[i];if(!u||!u.value){console.log("No column ref for status:",i,l);return}const E=u.value.$el??u.value;E&&E.scrollIntoView&&E.scrollIntoView({behavior:"smooth",block:"center"})}function ye(i){const l=document.documentElement;i==="dark"?(l.classList.add("dark"),window.localStorage.setItem("theme","dark"),h.value=!0):(l.classList.remove("dark"),window.localStorage.setItem("theme","light"),h.value=!1),console.log("applyTheme ->",i,"html classes:",l.className)}function Ce(){ye(h.value?"light":"dark")}function ce({id:i,status:l,position:u}){F(i,l,u)}function me({task:i,fields:l}){U(i.id,l)}function fe({task:i}){te(i.id)}function pe({task:i,userId:l}){_(i.id,l)}async function Te(i){await N(i)&&(C.value=!1)}async function $e(){try{await ge.post("/logout")}catch{K.error("There was a problem logging you out. Please try again.");return}window.localStorage.removeItem("taskflow_api_key"),K.success("You have been logged out"),window.location.href="/"}function De(i){r.value=i||""}function be(i){f.value=i}function Me(i){U(i,{status:"done"})}return(i,l)=>(d(),c("div",qt,[l[16]||(l[16]=e("div",{class:"pointer-events-none absolute inset-0 overflow-hidden"},[e("div",{class:"mesh-layer bg-[radial-gradient(circle_at_top,_rgba(56,189,248,0.35)_0,_transparent_25%),radial-gradient(circle_at_bottom,_rgba(45,212,191,0.25)_0,_transparent_60%)] dark:bg-[radial-gradient(circle_at_top,_rgba(56,189,248,0.6)_0,_transparent_25%),radial-gradient(circle_at_bottom,_rgba(56,189,248,0.15)_0,_rgba(15,23,42,1)_60%)] animate-[mesh-move_45s_ease-in-out_infinite_alternate]"}),e("div",{class:"grid-overlay opacity-30 [background-image:linear-gradient(to_right,rgba(148,163,184,0.45)_1px,transparent_1px),linear-gradient(to_bottom,rgba(148,163,184,0.45)_1px,transparent_1px)] [background-size:56px_56px] dark:opacity-30 dark:mix-blend-soft-light dark:[background-image:linear-gradient(to_right,rgba(15,23,42,0.85)_1px,transparent_1px),linear-gradient(to_bottom,rgba(15,23,42,0.85)_1px,transparent_1px)]"})],-1)),e("div",Ft,[Q(B(Ue),{href:"/",class:"inline-flex cursor-pointer items-center gap-2 rounded-full border border-slate-300/80 bg-white/80 px-4 py-1.5 text-xs text-slate-700 shadow shadow-slate-200/60 backdrop-blur transition hover:border-emerald-400/80 hover:text-emerald-600 hover:bg-white dark:border-slate-700/70 dark:bg-slate-900/80 dark:text-slate-300 dark:shadow-slate-900/40 dark:hover:border-emerald-400/80 dark:hover:text-emerald-300 dark:hover:bg-slate-900"},{default:ee(()=>[...l[10]||(l[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5 opacity-70",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10 6l-6 6 6 6M20 12H4"})],-1),re(" Back to Portfolio ",-1)])]),_:1}),e("header",Ot,[l[13]||(l[13]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-lg font-semibold dark:text-slate-100"},"TaskFlow"),e("span",{class:"text-xs px-2 py-1 rounded-full bg-blue-100/80 text-blue-700 whitespace-nowrap"}," MediaHaus Squad ")],-1)),e("div",Rt,[e("div",zt,[P(e("input",{"onUpdate:modelValue":l[0]||(l[0]=u=>Ne(r)?r.value=u:null),type:"search",placeholder:"Search tasks...",class:"w-full sm:w-48 text-sm rounded-lg border border-slate-300 text-slate-600 dark:text-slate-400 dark:border-slate-700 bg-white dark:bg-slate-900 px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-400",onKeyup:l[1]||(l[1]=Y((...u)=>B(g)&&B(g)(...u),["enter"]))},null,544),[[q,B(r)]]),e("button",{type:"button",class:"inline-flex items-center gap-1 text-[11px] px-2 py-1 rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 text-slate-500 dark:text-slate-300",onClick:l[2]||(l[2]=u=>$.value=!0)},[...l[11]||(l[11]=[e("span",{class:"text-xs text-slate-400"},"âŒ˜K",-1),e("span",{class:"hidden xs:inline"},"Command palette",-1)])])]),e("div",Wt,[e("button",{type:"button",class:"text-sm px-3 py-1.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 active:scale-95 transition",onClick:l[3]||(l[3]=u=>C.value=!0),disabled:B(o)},[B(o)?(d(),c("span",Xt,[...l[12]||(l[12]=[e("span",{class:"h-3 w-3 rounded-full border-2 border-t-transparent border-white animate-spin"},null,-1),re(" Creating... ",-1)])])):(d(),c("span",Gt,"+ New"))],8,Ht),e("div",Yt,[w.value?(d(),c("div",{key:0,class:"w-7 h-7 rounded-full flex items-center justify-center text-[11px] font-semibold text-white",style:de({backgroundColor:w.value.avatar_color||"#0f766e"})},M(w.value.name.slice(0,1).toUpperCase()),5)):V("",!0),w.value?(d(),c("span",Jt,M(w.value.name),1)):V("",!0),e("button",{type:"button",class:"text-xs dark:text-white px-2 py-1 rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 hover:bg-slate-50 dark:hover:bg-slate-800 active:scale-95 transition flex items-center gap-1",onClick:Ce,"aria-label":h.value?"Switch to light mode":"Switch to dark mode"},[h.value?(d(),c("span",Zt,"ðŸŒž")):(d(),c("span",es,"ðŸŒ™")),e("span",ts,M(h.value?"Light":"Dark"),1)],8,Qt),e("button",{type:"button",class:"text-xs px-3 py-1.5 dark:text-white rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 hover:bg-slate-50 dark:hover:bg-slate-800 active:scale-95 transition",onClick:$e}," Logout ")])])])]),e("div",ss,[e("div",as,[l[14]||(l[14]=e("span",null,"Filter:",-1)),e("button",{type:"button",class:Z(["px-2 py-0.5 rounded-full border text-[11px]",f.value==="all"?"bg-blue-600 text-white border-blue-600":"bg-white dark:bg-slate-900 border-slate-300 dark:border-slate-700"]),onClick:l[4]||(l[4]=u=>be("all"))}," All ",2),e("button",{type:"button",class:Z(["px-2 py-0.5 rounded-full border text-[11px]",f.value==="me"?"bg-blue-600 text-white border-blue-600":"bg-white dark:bg-slate-900 border-slate-300 dark:border-slate-700"]),onClick:l[5]||(l[5]=u=>be("me"))}," My tasks ",2)]),l[15]||(l[15]=e("div",{class:"text-[11px] text-slate-400"}," Press Cmd+K or Ctrl+K for the command palette ",-1))]),e("div",ls,[!m.value||m.value==="todo"?(d(),W(ve,{key:0,ref_key:"todoColumnRef",ref:y,title:"To Do",status:"todo",tasks:x.value,"is-loading":B(t),"team-members":v.teamMembers,onMoveTask:ce,onEditTask:me,onDeleteTask:fe,onAssignTask:pe,onOpenCreate:l[6]||(l[6]=u=>C.value=!0)},null,8,["tasks","is-loading","team-members"])):V("",!0),!m.value||m.value==="in_progress"?(d(),W(ve,{key:1,ref_key:"inProgressColumnRef",ref:n,title:"In Progress",status:"in_progress",tasks:k.value,"is-loading":B(t),"team-members":v.teamMembers,onMoveTask:ce,onEditTask:me,onDeleteTask:fe,onAssignTask:pe},null,8,["tasks","is-loading","team-members"])):V("",!0),!m.value||m.value==="done"?(d(),W(ve,{key:2,ref_key:"doneColumnRef",ref:p,title:"Done",status:"done",tasks:xe.value,"is-loading":B(t),"team-members":v.teamMembers,onMoveTask:ce,onEditTask:me,onDeleteTask:fe,onAssignTask:pe},null,8,["tasks","is-loading","team-members"])):V("",!0)])]),Q(_t,{show:C.value,"team-members":v.teamMembers,onClose:l[7]||(l[7]=u=>C.value=!1),onSubmit:Te},null,8,["show","team-members"]),Q(Bt,{show:$.value,"onUpdate:show":l[8]||(l[8]=u=>$.value=u),tasks:B(T),"team-members":v.teamMembers,"current-user-id":D.value,onCreateTask:l[9]||(l[9]=u=>C.value=!0),onSetSearch:De,onSetFilterAssigned:be,onSwitchColumn:_e,onMarkTaskDone:Me},null,8,["show","tasks","team-members","current-user-id"])]))}},ds=ie(os,[["__scopeId","data-v-26878a91"]]);export{ds as default};
